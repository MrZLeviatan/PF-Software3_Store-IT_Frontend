<div class="login-wrapper">
  <!-- Logo arriba izquierda -->
  <div class="logo-container" (click)="irInicio()" style="cursor: pointer">
    <img
      src="https://res.cloudinary.com/dehltwwbu/image/upload/f_auto,q_auto/v1756972307/StoreIt-logo-azul_cq41qg.png"
      alt="Logo"
    />
  </div>

  <!-- Lado izquierdo con imagen -->
  <div class="login-image">
    <img
      src="https://res.cloudinary.com/dehltwwbu/image/upload/f_auto,q_auto/v1757145314/logoLogin_m9qazj.png"
      alt="Imagen de inicio de sesi칩n"
    />
  </div>

  <!-- Lado derecho con formulario -->
  <div class="login-form-container">
    <h2>Bienvenido a Store-IT!</h2>
    <p class="login-subtitle">Inicia sesi칩n en tu cuenta</p>

    <form [formGroup]="loginForm" (ngSubmit)="onSubmit()">
      <!-- Email -->
      <div class="form-group floating-label">
        <input
          type="email"
          id="email"
          placeholder=" "
          formControlName="email"
          [class.invalid]="isInvalid('email')"
        />
        <label for="email">Correo Electr칩nico</label>
        <div *ngIf="isInvalid('email')" class="error-icon" [title]="'Ingresa un email v치lido'">
          <i class="fa fa-exclamation-circle"></i>
        </div>
      </div>

      <!-- Contrase침a -->
      <div class="form-group floating-label password-group">
        <input
          [type]="mostrarPassword ? 'text' : 'password'"
          id="password"
          placeholder=" "
          formControlName="password"
          [class.invalid]="isInvalid('password')"
        />
        <label for="password">Contrase침a</label>
        <button type="button" class="toggle-btn" (click)="togglePassword()">
          <i [ngClass]="mostrarPassword ? 'fa fa-eye-slash' : 'fa fa-eye'"></i>
        </button>
        <div
          *ngIf="isInvalid('password')"
          class="error-icon"
          [title]="'La contrase침a es obligatoria'"
        >
          <i class="fa fa-exclamation-circle"></i>
        </div>
      </div>

      <!-- 游댳 Link restablecer contrase침a -->
      <p class="forgot-password">
        <a href="#" (click)="solicitarRestablecerPassword($event)">쯆lvidaste tu contrase침a?</a>
      </p>

      <!-- Bot칩n login -->
      <div class="form-group">
        <button type="submit" [disabled]="loginForm.invalid" class="submit-btn">
          Iniciar sesi칩n
        </button>
      </div>
    </form>

    <!-- Separador social -->

    <!-- Separador "o contin칰a con" -->
    <div class="social-separator">
      <span>o contin칰a con</span>
    </div>

    <!-- Bot칩n Google -->
    <div class="social-buttons">
      <!-- Aqu칤 Google renderiza el bot칩n -->
      <div id="googleBtn"></div>
    </div>

    <!-- Link de contacto / registro -->
    <p class="register-link">쯅o tienes una cuenta? <a href="/registroClientes"> Reg칤strate</a></p>
  </div>

  <!-- 游댳 Overlay de verificaci칩n -->
  <div class="overlay" *ngIf="mostrarVerificacion">
    <div class="verificacion-modal">
      <h3>Autentificaci칩n de Inicio de Sesi칩n</h3>
      <p>
        Hemos enviado un c칩digo de autentificaci칩n al correo
        <strong>{{ emailVerificacion }}</strong
        >.
      </p>

      <form [formGroup]="formCodigo" (ngSubmit)="confirmarVerificacion()">
        <div class="form-group">
          <input
            type="text"
            formControlName="codigo"
            maxlength="6"
            class="codigo-input"
            placeholder="------"
            (input)="forzarMayusculas($event)"
          />
        </div>

        <div class="modal-buttons">
          <button type="submit" class="submit-btn">Confirmar</button>
          <button type="button" (click)="cancelarVerificacion()" class="cancel-btn">
            Cancelar
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modal restablecer contrase침a -->
  <div class="modal-backdrop" *ngIf="mostrarModalPassword">
    <div class="modal">
      <h3>Restablecer contrase침a</h3>
      <p>Introduce tu correo electr칩nico para recibir un enlace de restablecimiento.</p>

      <form [formGroup]="solicitudForm" (ngSubmit)="enviarSolicitudRestablecer()">
        <!-- Email -->
        <div class="form-group floating-label">
          <input
            type="email"
            id="email"
            placeholder=" "
            formControlName="email"
            [class.invalid]="isInvalidSolicitud('email')"
          />
          <label for="email">Correo Electr칩nico</label>
          <!-- 칈cono de error -->
          <div
            *ngIf="isInvalidSolicitud('email')"
            class="error-icon"
            [title]="'Ingresa un email v치lido'"
          >
            <i class="fa fa-exclamation-circle"></i>
          </div>
        </div>

        <div class="modal-actions">
          <button type="submit">Enviar</button>
          <button type="button" (click)="cerrarModal()">Cancelar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- 游댳 Modal para verificar c칩digo -->
  <div class="overlay" *ngIf="mostrarCodigoRestablecer">
    <div class="verificacion-modal">
      <h3>Verificaci칩n de C칩digo</h3>
      <p>
        Hemos enviado un c칩digo de verificaci칩n al correo
        <strong>{{ emailVerificacion }}</strong
        >.
      </p>

      <form [formGroup]="formCodigoRestablecer" (ngSubmit)="confirmarCodigo()">
        <div class="form-group">
          <input
            type="text"
            formControlName="codigo"
            maxlength="6"
            class="codigo-input"
            placeholder="------"
            (input)="
              formCodigoRestablecer.patchValue({ codigo: $event.target.value.toUpperCase() })
            "
          />
        </div>

        <div class="modal-actions">
          <button type="submit" class="submit-btn">Confirmar</button>
          <button type="button" (click)="cancelarCodigo()" class="cancel-btn">Cancelar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modal nueva contrase침a -->
  <div class="modal-backdrop" *ngIf="mostrarNuevaPassword">
    <div class="modal">
      <h3>Establecer nueva contrase침a</h3>
      <p>Introduce tu nueva contrase침a para actualizar el acceso a tu cuenta.</p>

      <form [formGroup]="formNuevaPassword" (ngSubmit)="actualizarPassword()">
        <!-- Contrase침a -->
        <div class="form-group floating-label password-group">
          <input
            type="password"
            id="nuevaPassword"
            placeholder=" "
            formControlName="nuevaPassword"
            [class.invalid]="
              formNuevaPassword.get('nuevaPassword')?.invalid &&
              formNuevaPassword.get('nuevaPassword')?.touched
            "
          />
          <label for="nuevaPassword">Nueva Contrase침a</label>

          <!-- 游댳 칈cono de error -->
          <div
            *ngIf="
              formNuevaPassword.get('nuevaPassword')?.invalid &&
              formNuevaPassword.get('nuevaPassword')?.touched
            "
            class="error-icon"
            [title]="'La contrase침a debe tener m칤nimo 8 caracteres'"
          >
            <i class="fa fa-exclamation-circle"></i>
          </div>
        </div>

        <!-- Botones -->
        <div class="modal-actions">
          <button type="submit" class="submit-btn">Confirmar</button>
        </div>
      </form>
    </div>
  </div>
</div>
